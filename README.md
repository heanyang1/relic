# Relic

Relic (Rust-Enabled Lisp Interpreter and Compiler) is a minimal, self-contained Lisp system written in Rust. It contains an interpreter, a debugger, a compiler and a garbage collected runtime environment for a subset of Scheme in less than 4k lines of Rust code [^note1].

Currently Relic only supports a small subset of R5RS that is sufficient to run most programs in [SICP](https://mitp-content-server.mit.edu/books/content/sectbyfn/books_pres_0/6515/sicp.zip/full-text/book/book.html) with minor modifications. It has a few extensions such as printing the environment as DOT graph, which may be useful in solving several exercises in SICP. More features of Scheme will be added as long as the feature does not add too much complexity to the system.

Relic is compiled to WebAssembly and can be run on the web. [Try Relic online!]()

[^note1]: The line count does not contain test code.

## Compile and Run

Run the interpreter:
```sh
cargo run -- repl
```

Run `cargo run -- --help` to see the usage.

Compile and run Lisp code:
```sh
# Lisp -> C
cargo run -- compile program.lisp program.c
# C -> executable
# You need to include `c_runtime/runtime.h` and link `target/debug/librelic.so`
clang -Ic_runtime -o program program.c -Ltarget/debug -lrelic -Wl,-rpath,target/debug
# Run the program
./program
```

Compile Relic to WebAssembly:
```sh
wasm-pack build --target web
```

## Testing

There is a Python script to test the C code generated by the compiler:
```sh
# Writes C code to `c_runtime/tests`
cargo test
cd c_runtime
# Compile the tests
./run_tests.py
```

## License

MIT OR Apache 2.0
